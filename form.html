<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Document</title>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="src/css/form-style.css" />
	<script src="https://telegram.org/js/telegram-web-app.js"></script>

</head>

<body>
	<div class="form-body">
		<form id="reg-form" class="reg-form">
			<h1 class="title-from">Регистрация</h1>
			<div class="form-fields">
				<div class="form-item">
					<input class="form-item__input" onchange="changeFunc(this.value)" data-val="false" name="user_name"
						placeholder="Ваше имя*" type="text">
				</div>
				<div class="form-item">
					<input class="form-item__input" onchange="changeFunc(this.value)" name="user_surname"
						placeholder="Ваша фамилия*" type="text">
				</div>
				<div class="form-item">
					<input class="form-item__input" onchange="changeFunc(this.value)" name="car_model_name"
						placeholder="Марка и модель авто*" type="text">
				</div>
				<div class="form-item">
					<input class="form-item__input" onchange="changeFunc(this.value)" name="car_year"
						placeholder="Год выпуска авто*" type="number">
				</div>
				<div class="form-item">
					<input class="form-item__input" onchange="changeFunc(this.value)" name="car_grz" placeholder="Номер авто*"
						type="text" maxlength="9">
				</div>
				<div class="form-item">
					<input class="form-item__input" name="car_engine_name" placeholder="Модель двигателя авто" type="text"
						maxlength="4">
				</div>
				<div class="form-item form-item-files">
					<p>Фото вашего авто:</p>
					<input class="form-item__input form-item-files-input" name="car_photo" type="file" multiple
						accept="image/jpeg,image/png,image/jpg, impage/HEIC">
				</div>
			</div>
			<div class="form-footer">
				<div class="form-note">
					Поля со * обязательны к заполнению
				</div>
			</div>
		</form>

	</div>
	<script>

		let tg = window.Telegram.WebApp;

		tg.MainButton.show();

		let form = document.querySelector('#reg-form');
		let sendBtn = document.querySelector('#send-btn');

		let user_name = document.querySelector('input[name="user_name"]');
		let user_surname = document.querySelector('input[name="user_surname"]');
		let car_model_name = document.querySelector('input[name="car_model_name"]');
		let car_year = document.querySelector('input[name="car_year"]');
		let car_grz = document.querySelector('input[name="car_grz"]');
		let car_engine_name = document.querySelector('input[name="car_engine_name"]');
		// let user_id = tg.initDataUnsafe.user.id;

		function changeFunc(val) {
			if (val.length != '' && val.length > 3) {
				console.log('fff');
			} else {
				alert('Не хватает символов!');
			}
		}

		if (user_name.value == '') {
			tg.MainButton.disable()
		} else {
			tg.MainButton.enable()
			Telegram.WebApp.onEvent('mainButtonClicked', function () {
				tg.sendData(
					`${user_name.value}\n${user_surname.value}`);
				//при клике на основную кнопку отправляем данные в строковом виде
				tg.close();
			});
		}




		/* user = {
			chat_id: user_id,
			user_name: user_name.value,
			user_surname: user_surname.value,
			car_name: car_model_name.value,
			car_year: car_year.value,
			car_grz: car_grz.value,
			car_engine_name: car_engine_name.value
		} */

		/* let year = getFullYear(); */
		let date = new Date();
		let year = date.getFullYear();

	</script>
</body>

</html>